# If any ^to-store <lti> wmes exist, store them in smem

# elaborate ^goals-to-store true flag if any ^to-store <lti> exist
sp {add-procedural-subgoal*elaborate*goals-to-store
   (state <s> ^name add-procedural-subgoal
              ^to-store <lti>)
-->
   (<s> ^goals-to-store true)
}

# propose store-goal-graph if ^goals-to-store true is present
sp {add-procedural-subgoal*propose*store-goal-graph
   (state <s> ^name add-procedural-subgoal
              ^goals-to-store true)
-->
   (<s> ^operator <o> + <)
   (<o> ^name store-goal-graph)
}

# apply: mark stored-goals true
sp {add-procedural-subgoal*apply*store-goal-graph*mark*stored
   (state <s> ^name add-procedural-subgoal
              ^operator.name store-goal-graph)
-->
   (<s> ^stored-goals true)
}

# create store command on smem.command link and remove ^to-store wmes
sp {add-procedural-subgoal*apply*store-goal-graph*store
   (state <s> ^name add-procedural-subgoal
              ^operator.name store-goal-graph
              ^smem.command <cmd>
              ^to-store <lti>)
-->
   (<cmd> ^store <lti>)
   (<s> ^to-store <lti> -)
}
